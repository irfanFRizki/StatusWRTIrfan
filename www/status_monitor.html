<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OpenWRT Status Dashboard</title>
  
  <!-- External Resources -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script type="text/javascript" src="https://192.168.1.1:19999/dashboard.js"></script>

  <style>
    /* Variabel dasar untuk tampilan ringan (light mode) */
    :root {
      --background-color: #fafafa;              /* Warna latar yang lembut */
      --text-color: #333333;                    /* Teks gelap namun tidak terlalu kontras */
      --box-background: rgba(255, 255, 255, 0.85);/* Sedikit transparan agar tampilan terasa modern */
      --accent-color: #4a90e2;                   /* Biru lembut sebagai aksen */
      --secondary-color: #50e3c2;                /* Hijau kebiruan yang segar */
      --danger-color: #d0021b;
      --border-radius: 12px;
      --box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      --gradient-accent: linear-gradient(45deg, #4a90e2, #50e3c2);
    }

    /* Tampilan untuk dark mode */
    [data-theme="dark"] {
  --background-color: #1e1e1e;
  --text-color: #000000; 
  --box-background: #2a2a2a;
  --accent-color: #f5a623;
  --secondary-color: #8b572a;
  --gradient-accent: linear-gradient(45deg, #f5a623, #8b572a);
}

    /* Animasi */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    body {
      font-family: 'Poppins', sans-serif;
      font-weight: 500;
      background-color: var(--background-color);
      color: var(--text-color);
      margin: 0;
      padding: 0;
      text-align: center;
      transition: background-color 0.5s ease, color 0.5s ease;
    }

    header {
      background-color: var(--box-background);
      padding: 15px;
      box-shadow: var(--box-shadow);
      text-align: center;
    }

    header h1 {
      margin: 0;
      font-size: 1.5em;
      color: var(--accent-color);
      font-weight: 600;
    }

    nav {
      display: flex;
      justify-content: center;
      background-color: var(--box-background);
      border-bottom: 1px solid var(--accent-color);
    }

    nav button {
      background: var(--gradient-accent);
      border-radius: 12px;
      padding: 18px 25px;
      margin: 0 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      font-size: 1em;
      text-transform: uppercase;
      color: #ffffff;
      font-weight: 600;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    nav button:hover, nav button.active {
      background-color: var(--accent-color);
      color: #fff;
      transform: translateY(-3px);
      box-shadow: 0 8px 15px rgba(74, 144, 226, 0.3);
    }

    main {
      padding: 20px;
      display: none;
    }

    main.active {
      display: block;
    }

    .status-box {
      background-color: var(--box-background);
      box-shadow: var(--box-shadow);
      border-radius: var(--border-radius);
      margin: 15px auto;
      padding: 20px;
      width: 90%;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .status-box:hover {
      transform: translateY(-8px) rotateX(10deg);
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }

    .status-title {
      font-size: 1.3em;
      margin-bottom: 10px;
      color: var(--accent-color);
      text-transform: uppercase;
      letter-spacing: 1.5px;
      font-weight: 700;
    }

    .sub-box {
      background-color: var(--box-background);
      box-shadow: var(--box-shadow);
      border-radius: var(--border-radius);
      margin: 10px;
      padding: 15px;
      text-align: left;
      transition: transform 0.3s, box-shadow 0.3s;
      animation: fadeInUp 1s ease-in-out;
    }

    .sub-box:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
    }

    .vnstat-title {
      font-size: 1.3em;
      margin-bottom: 10px;
      color: var(--secondary-color);
    }

    .vnstat-data {
      font-size: 0.9em;
      color: var(--text-color);
      animation: fadeInUp 1.2s ease-in-out;
    }
    
    @keyframes shimmer {
      0% { background-position: -1000px 0; }
      100% { background-position: 1000px 0; }
    }

    .skeleton-loading {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite linear;
      border-radius: 8px;
    }

    .gauge {
      width: 160px;
      height: 160px;
      filter: drop-shadow(0 10px 8px rgba(74, 144, 226, 0.1));
      position: relative;
      margin: 15px auto;
    }

    .gauge circle {
      fill: none;
      stroke-width: 12;
      stroke-linecap: round;
    }

    .gauge-background {
      stroke: #e0e0e0;
    }

    .gauge-progress {
      stroke-width: 14;
      stroke-linecap: round;
      filter: url(#shadow);
      stroke: var(--accent-color);
      stroke-dasharray: 100;
      stroke-dashoffset: 100;
      transform: rotate(-90deg);
      transform-origin: 50% 50%;
      transition: stroke-dashoffset 0.5s ease, stroke 0.5s ease;
    }

    .gauge-value {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 1.3em;
      color: #ffffff;
      font-weight: 600;
    }

    .gauge-label {
      font-size: 1em;
      color: var(--text-color);
      margin-top: 8px;
    }

    .top-bar {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      position: relative;
      margin-bottom: 20px;
    }

    .theme-toggle {
      background: var(--gradient-accent);
      border-radius: 50%;
      padding: 12px;
      margin: 0;
      background-color: transparent;
      border: none;
      cursor: pointer;
      font-size: 2em;
      transition: transform 0.3s;
    }

    .theme-toggle img {
      width: 50px;
      height: 50px;
      transition: transform 0.3s ease;
    }

    .theme-toggle:hover {
      transform: rotate(180deg) scale(1.1);
    }

    .uptime-box {
      background-color: var(--box-background);
      padding: 12px;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      display: inline-block;
      margin: 0 20px;
    }

    .uptime-title {
      font-size: 1.2em;
      color: var(--accent-color);
    }

    .uptime-value {
      font-size: 1.5em;
      color: var(--text-color);
    }

    table {
      backdrop-filter: blur(6px);
      background: rgba(255, 255, 255, 0.75);
      border-radius: 12px;
      overflow: hidden;
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0;
      text-align: left;
    }

    table th, table td {
      padding: 8px 12px;
      border: 1px solid var(--accent-color);
    }

    table th {
      color: #ffffff;
      background: var(--gradient-accent);
      backdrop-filter: blur(6px);
      font-weight: 600;
      text-transform: uppercase;
      font-size: 0.9em;
    }

    table td {
      color: var(--text-color);
      font-weight: 500;
      font-size: 0.85em;
    }
    
    table tr:nth-child(even) {
      background: rgba(74, 144, 226, 0.05);
    }

    /* Sub-navigation styles */
    .sub-nav {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }

    .sub-nav button {
      background: none;
      border: none;
      padding: 10px 15px;
      cursor: pointer;
      font-size: 1em;
      text-transform: uppercase;
      color: var(--text-color);
      transition: background 0.3s, color 0.3s;
    }

    .sub-nav button:hover, .sub-nav button.active {
      background-color: var(--secondary-color);
      color: #fff;
    }

    .interface-section {
      display: none;
    }

    .interface-section.active {
      display: block;
    }

    /* Tombol Edit (Hijau) */
    button.edit-button {
      background-color: #2ecc71;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    button.edit-button:hover {
      background-color: #27ae60;
    }

    /* Tombol Delete (Merah) */
    button.delete-button {
      background-color: #e74c3c;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    button.delete-button:hover {
      background-color: #c0392b;
    }

    /* Tombol Tambah Paket Baru (Kuning) */
    button.add-button {
      background-color: #f1c40f;
      color: black;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1em;
      transition: background-color 0.3s;
    }

    button.add-button:hover {
      background-color: #f39c12;
    }

    /* Tombol Export dan Import (Biru) */
    button.blue-button, label.blue-button {
      background-color: #3498db;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1em;
      transition: background-color 0.3s;
    }

    button.blue-button:hover, label.blue-button:hover {
      background-color: #2980b9;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.5);
    }

    .modal-content {
      background-color: var(--box-background);
      margin: 10% auto;
      padding: 20px;
      border: 1px solid var(--accent-color);
      width: 80%;
      max-width: 500px;
      border-radius: var(--border-radius);
    }

    .modal-content h2 {
      margin-top: 0;
      color: var(--accent-color);
    }

    .modal-content label {
      display: block;
      margin: 10px 0 5px;
      text-align: left;
    }

    .modal-content select, .modal-content input {
      width: 100%;
      padding: 8px;
      border: 1px solid var(--accent-color);
      border-radius: 5px;
      background-color: transparent;
      color: var(--text-color);
    }

    .modal-content button {
      margin-top: 15px;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      background-color: var(--accent-color);
      color: #fff;
      font-size: 1em;
    }

    .modal-content button:hover {
      background-color: var(--secondary-color);
    }

    .close-button {
      background-color: #e74c3c;
      float: right;
      font-size: 1.2em;
      padding: 5px 10px;
      cursor: pointer;
      color: #fff;
      border: none;
      border-radius: 5px;
    }

    .close-button:hover {
      background-color: #c0392b;
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle Theme">
      <img id="theme-icon" src="https://img.icons8.com/ios-filled/50/000000/sun--v1.png" alt="Theme Icon" />
    </button>
    <div class="uptime-box">
      <div class="uptime-title">System Uptime</div>
      <div class="uptime-value" id="uptime">--</div>
    </div>
  </div>
  <header>
    <h1>OpenWRT Status Dashboard</h1>
    <p>Monitor your network performance in real-time</p>
  </header>

  <nav>
    <button onclick="showTab('internet')" class="active" id="internet-tab">üåê Data Internet</button>
    <button onclick="showTab('cpu')" id="cpu-tab">üî• CPU</button>
    <button onclick="showTab('ram')" id="ram-tab">üíæ RAM & Disk</button>
    <button onclick="showTab('biaya')" id="biaya-tab">üí∞ Biaya</button>
    <button onclick="showTab('bandwidth')" id="bandwidth-tab">üì∂ Bandwidth</button>
  </nav>

  <!-- Data Internet Tab -->
  <main id="internet" class="active">
    <nav class="sub-nav">
      <button onclick="showInterface('XL')" class="active" id="XL-button">XL</button>
      <button onclick="showInterface('jakwifi')" id="jakwifi-button">JAKWIFI</button>
      <button onclick="showInterface('raspi4b')" id="raspi4b-button">Raspi 4B</button>
    </nav>

    <!-- XL Section -->
    <div id="XL-section" class="interface-section active">
      <div class="status-box">
        <div class="status-title">Penggunaan Data Internet - XL</div>
        <div class="sub-box">
          <div class="vnstat-title">XL</div>
          <table>
            <thead>
              <tr>
                <th>Periode</th>
                <th>Tanggal</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Hari ini</td>
                <td id="wwan0-today-date">--</td>
                <td id="wwan0-today-total">--</td>
              </tr>
              <tr>
                <td>Bulan ini</td>
                <td id="wwan0-month-date">--</td>
                <td id="wwan0-month-total">--</td>
              </tr>
              <tr>
                <td>Bulan lalu</td>
                <td id="wwan0-last-month-date">--</td>
                <td id="wwan0-last-month-total">--</td>
              </tr>
            </tbody>
            <thead>
              <tr>
                <th>Minggu</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Minggu 1 (1-7)</td>
                <td id="wwan0-week1-total">--</td>
              </tr>
              <tr>
                <td>Minggu 2 (8-14)</td>
                <td id="wwan0-week2-total">--</td>
              </tr>
              <tr>
                <td>Minggu 3 (15-21)</td>
                <td id="wwan0-week3-total">--</td>
              </tr>
              <tr>
                <td>Minggu 4 (22-28)</td>
                <td id="wwan0-week4-total">--</td>
              </tr>
              <tr>
                <td>Minggu Terakhir (29-31)</td>
                <td id="wwan0-week5-total">--</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- JAKWIFI Section -->
    <div id="jakwifi-section" class="interface-section">
      <div class="status-box">
        <div class="status-title">Penggunaan Data Internet - JAKWIFI</div>
        <div class="sub-box">
          <div class="vnstat-title">JAKWIFI</div>
          <table>
            <thead>
              <tr>
                <th>Periode</th>
                <th>Tanggal</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Hari ini</td>
                <td id="usb0-today-date">--</td>
                <td id="usb0-today-total">--</td>
              </tr>
              <tr>
                <td>Bulan ini</td>
                <td id="usb0-month-date">--</td>
                <td id="usb0-month-total">--</td>
              </tr>
              <tr>
                <td>Bulan lalu</td>
                <td id="usb0-last-month-date">--</td>
                <td id="usb0-last-month-total">--</td>
              </tr>
            </tbody>
            <thead>
              <tr>
                <th>Minggu</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Minggu 1 (1-7)</td>
                <td id="usb0-week1-total">--</td>
              </tr>
              <tr>
                <td>Minggu 2 (8-14)</td>
                <td id="usb0-week2-total">--</td>
              </tr>
              <tr>
                <td>Minggu 3 (15-21)</td>
                <td id="usb0-week3-total">--</td>
              </tr>
              <tr>
                <td>Minggu 4 (22-28)</td>
                <td id="usb0-week4-total">--</td>
              </tr>
              <tr>
                <td>Minggu Terakhir (29-31)</td>
                <td id="usb0-week5-total">--</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Raspi 4B Section -->
    <div id="raspi4b-section" class="interface-section">
      <div class="status-box">
        <div class="status-title">Penggunaan Data Internet - Raspi 4B</div>
        <div class="sub-box">
          <div class="vnstat-title">Raspi 4B</div>
          <table>
            <thead>
              <tr>
                <th>Periode</th>
                <th>Tanggal</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Hari ini</td>
                <td id="br-lan-today-date">--</td>
                <td id="br-lan-today-total">--</td>
              </tr>
              <tr>
                <td>Bulan ini</td>
                <td id="br-lan-month-date">--</td>
                <td id="br-lan-month-total">--</td>
              </tr>
              <tr>
                <td>Bulan lalu</td>
                <td id="br-lan-last-month-date">--</td>
                <td id="br-lan-last-month-total">--</td>
              </tr>
            </tbody>
            <thead>
              <tr>
                <th>Minggu</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Minggu 1 (1-7)</td>
                <td id="br-lan-week1-total">--</td>
              </tr>
              <tr>
                <td>Minggu 2 (8-14)</td>
                <td id="br-lan-week2-total">--</td>
              </tr>
              <tr>
                <td>Minggu 3 (15-21)</td>
                <td id="br-lan-week3-total">--</td>
              </tr>
              <tr>
                <td>Minggu 4 (22-28)</td>
                <td id="br-lan-week4-total">--</td>
              </tr>
              <tr>
                <td>Minggu Terakhir (29-31)</td>
                <td id="br-lan-week5-total">--</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </main>

  <!-- CPU Tab -->
  <main id="cpu">
    <div class="status-box">
      <div class="status-title">CPU</div>
      <div class="gauge-card">
        <div class="gauge">
          <svg width="120" height="120" aria-labelledby="cpuTempTitle">
            <circle class="gauge-background" cx="60" cy="60" r="50" />
            <circle class="gauge-progress" cx="60" cy="60" r="50" id="cpu-temp-gauge" />
          </svg>
          <defs>
            <filter id="shadow">
              <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="rgba(74, 144, 226, 0.3)" />
            </filter>
          </defs>
          <div class="gauge-value" id="cpu-temp-value">--¬∞C</div>
        </div>
        <div class="gauge-label">üî• CPU Temperature</div>
      </div>
      <div class="gauge">
        <svg width="120" height="120" aria-labelledby="cpuLoadTitle">
          <circle class="gauge-background" cx="60" cy="60" r="50" />
          <circle class="gauge-progress" cx="60" cy="60" r="50" id="cpu-load-gauge" />
        </svg>
        <div class="gauge-value" id="cpu-load-value">--%</div>
      </div>
      <div class="gauge-label" id="cpuLoadTitle">Load</div>
    </div>
  </main>

  <!-- RAM & Disk Tab -->
  <main id="ram">
    <div class="status-box">
      <div class="status-title">RAM & Disk</div>
      <div class="gauge">
        <svg width="120" height="120" aria-labelledby="ramUsageTitle">
          <circle class="gauge-background" cx="60" cy="60" r="50" />
          <circle class="gauge-progress" cx="60" cy="60" r="50" id="ram-usage-gauge" />
        </svg>
        <div class="gauge-value" id="ram-usage-value">--%</div>
      </div>
      <div class="gauge-label" id="ramUsageTitle">RAM Usage</div>
      <div class="gauge">
        <svg width="120" height="120" aria-labelledby="diskUsageTitle">
          <circle class="gauge-background" cx="60" cy="60" r="50" />
          <circle class="gauge-progress" cx="60" cy="60" r="50" id="disk-usage-gauge" />
        </svg>
        <div class="gauge-value" id="disk-usage-value">--%</div>
      </div>
      <div class="gauge-label" id="diskUsageTitle">Disk Usage</div>
    </div>
  </main>

  <!-- Biaya Tab -->
  <main id="biaya">
    <nav class="sub-nav">
      <button onclick="showBiayaInterface('detail')" class="active" id="biaya-detail-button">Detail</button>
      <button onclick="showBiayaInterface('rekap')" id="biaya-rekap-button">Rekap</button>
    </nav>
    <div id="biaya-detail-section" class="interface-section active">
      <div class="status-box">
        <div class="status-title">Penggunaan Biaya</div>
        <button class="add-button" onclick="addNewRow()">‚ûï Tambah Paket Baru</button>
        <div style="margin-top: 15px;">
          <button class="blue-button" onclick="exportBiayaData()">Export Data</button>
          <label for="import-file" class="blue-button" style="margin-left: 10px;">Import Data</label>
          <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importBiayaData(event)" />
        </div>
        <table>
          <thead>
            <tr>
              <th>Tanggal Beli</th>
              <th>Tanggal Habis</th>
              <th>Nama Paket</th>
              <th>Kuota</th>
              <th>Biaya</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody id="biaya-table-body"></tbody>
          <tfoot>
            <tr>
              <td colspan="3" style="text-align: right; font-weight: bold;">Total Kuota</td>
              <td id="total-kuota" style="font-weight: bold;">--</td>
              <td></td>
            </tr>
            <tr>
              <td colspan="4" style="text-align: right; font-weight: bold;">Total Biaya</td>
              <td id="total-biaya" style="font-weight: bold;">--</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
    <div id="biaya-rekap-section" class="interface-section">
      <div class="status-box">
        <div class="status-title">Rekap Penggunaan Biaya</div>
        <table>
          <thead>
            <tr>
              <th>Bulan</th>
              <th>Total Biaya</th>
              <th>Total Kuota</th>
            </tr>
          </thead>
          <tbody id="rekap-biaya-body"></tbody>
          <tfoot>
            <tr>
              <td style="text-align: right; font-weight: bold;">Total Keseluruhan</td>
              <td id="total-keseluruhan-biaya" style="font-weight: bold;">--</td>
              <td id="total-keseluruhan-kuota" style="font-weight: bold;">--</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </main>

  <!-- Bandwidth Tab -->
  <main id="bandwidth" class="interface-section">
    <div class="status-box">
      <div class="status-title">Penggunaan Bandwidth Per-IP</div>
      <div id="current-month" style="margin-bottom: 10px; font-size: 1em; color: var(--text-color);"></div>
      <table id="bandwidth-data" class="styled-table">
        <thead>
          <tr>
            <th>#</th>
            <th>üì± Nama Device</th>
            <th>üåê IP Address</th>
            <th>üîó MAC Address</th>
            <th>‚¨áÔ∏è Download</th>
            <th>‚¨ÜÔ∏è Upload</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </main>

  <!-- Modal untuk Form Tambah/Edit Paket -->
  <div id="modal-form" class="modal">
    <div class="modal-content">
      <button class="close-button" onclick="closeModal()">X</button>
      <h2>Tambah Paket Baru</h2>
      <form id="add-package-form">
        <label for="tanggal-beli-YYYY">Masukkan Tanggal Beli:</label>
        <div style="display: flex; gap: 5px;">
          <select id="tanggal-beli-YYYY" required>
            <option value="" disabled selected>YYYY</option>
            <option value="2024">2024</option>
            <option value="2025">2025</option>
          </select>
          <select id="tanggal-beli-MM" required>
            <option value="" disabled selected>MM</option>
            <option value="01">Januari</option>
            <option value="02">Februari</option>
            <option value="03">Maret</option>
            <option value="04">April</option>
            <option value="05">Mei</option>
            <option value="06">Juni</option>
            <option value="07">Juli</option>
            <option value="08">Agustus</option>
            <option value="09">September</option>
            <option value="10">Oktober</option>
            <option value="11">November</option>
            <option value="12">Desember</option>
          </select>
          <select id="tanggal-beli-DD" required>
            <option value="" disabled selected>DD</option>
            <script>
              for(let i=1; i<=31; i++) {
                document.write(`<option value="${i.toString().padStart(2, '0')}">${i}</option>`);
              }
            </script>
          </select>
        </div>

        <label for="tanggal-habis-YYYY">Masukkan Tanggal Habis:</label>
        <div style="display: flex; gap: 5px;">
          <select id="tanggal-habis-YYYY" required>
            <option value="" disabled selected>YYYY</option>
            <option value="2024">2024</option>
            <option value="2025">2025</option>
          </select>
          <select id="tanggal-habis-MM" required>
            <option value="" disabled selected>MM</option>
            <option value="01">Januari</option>
            <option value="02">Februari</option>
            <option value="03">Maret</option>
            <option value="04">April</option>
            <option value="05">Mei</option>
            <option value="06">Juni</option>
            <option value="07">Juli</option>
            <option value="08">Agustus</option>
            <option value="09">September</option>
            <option value="10">Oktober</option>
            <option value="11">November</option>
            <option value="12">Desember</option>
          </select>
          <select id="tanggal-habis-DD" required>
            <option value="" disabled selected>DD</option>
            <script>
              for(let i=1; i<=31; i++) {
                document.write(`<option value="${i.toString().padStart(2, '0')}">${i}</option>`);
              }
            </script>
          </select>
        </div>

        <label for="nama-paket">Masukkan Nama Paket:</label>
        <select id="nama-paket" required>
          <option value="" disabled selected>Pilih Paket</option>
          <option value="ilmupedia harian">ilmupedia harian</option>
          <option value="ilmupedia mingguan">ilmupedia mingguan</option>
          <option value="HOT PROMO bulanan">HOT PROMO bulanan</option>
        </select>

        <label for="kuota-paket">Masukkan Kuota Paket (dalam GB):</label>
        <input type="number" id="kuota-paket" placeholder="Contoh: 50" min="0" required />

        <label for="biaya-paket">Masukkan Biaya Paket (tanpa Rp):</label>
        <input type="number" id="biaya-paket" placeholder="Contoh: 150000" min="0" required />

        <button type="submit">Simpan</button>
      </form>
    </div>
  </div>

    <!-- JavaScript -->
    <script>
        // Data default
        const defaultBiayaData = [
            {
                tanggal_beli: '2024-01-01',
                tanggal_habis: '2024-01-31',
                nama_paket: 'Internet Bulanan 50GB',
                kuota: '50GB',
                biaya: 150000
            },
            {
                tanggal_beli: '2024-02-01',
                tanggal_habis: '2024-02-28',
                nama_paket: 'Internet Bulanan 100GB',
                kuota: '100GB',
                biaya: 300000
            },
            {
                tanggal_beli: '2024-03-01',
                tanggal_habis: '2024-03-31',
                nama_paket: 'Paket Unlimited',
                kuota: 'Unlimited',
                biaya: 500000
            }
        ];

        // Fungsi untuk mengekspor data biaya sebagai file JSON
        function exportBiayaData() {
            const savedData = localStorage.getItem('biayaData');
            const biayaData = savedData ? JSON.parse(savedData) : defaultBiayaData;

            const dataStr = JSON.stringify(biayaData, null, 4);
            const blob = new Blob([dataStr], { type: "application/json" });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = `biaya_data_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Fungsi untuk mengimpor data biaya dari file JSON
        function importBiayaData(event) {
            const file = event.target.files[0];
            if (!file) {
                alert('Tidak ada file yang dipilih.');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);

                    // Validasi format data
                    if (!Array.isArray(importedData)) {
                        throw new Error('Format data tidak valid. Harus berupa array.');
                    }

                    importedData.forEach(entry => {
                        if (
                            typeof entry.tanggal_beli !== 'string' ||
                            typeof entry.tanggal_habis !== 'string' ||
                            typeof entry.nama_paket !== 'string' ||
                            typeof entry.kuota !== 'string' ||
                            typeof entry.biaya !== 'number'
                        ) {
                            throw new Error('Format data setiap entri tidak valid.');
                        }
                    });

                    // Simpan data ke localStorage
                    saveBiayaData(importedData);

                    // Muat ulang tabel dan rekap
                    loadBiayaData();
                    loadRekapBiaya();

                    alert('Data berhasil diimpor!');
                } catch (error) {
                    alert('Gagal mengimpor data: ' + error.message);
                    console.error('Error importing data:', error);
                }
            };
            reader.readAsText(file);

            // Reset file input
            event.target.value = '';
        }

        // Fungsi untuk menyimpan data ke localStorage
        function saveBiayaData(biayaData) {
            localStorage.setItem('biayaData', JSON.stringify(biayaData));
        }

        // Fungsi untuk membuka modal
        function addNewRow() {
            document.getElementById('modal-form').style.display = 'block';
        }

        // Fungsi untuk menutup modal
        function closeModal() {
            document.getElementById('modal-form').style.display = 'none';
            document.getElementById('add-package-form').reset();
            // Kembalikan event listener form submit ke default
            document.getElementById('add-package-form').onsubmit = addPackageSubmit;
        }

        // Event listener untuk submit form
        function addPackageSubmit(e) {
            e.preventDefault();

            // Ambil data dari form
            const tanggalBeli = `${document.getElementById('tanggal-beli-YYYY').value}-${document.getElementById('tanggal-beli-MM').value}-${document.getElementById('tanggal-beli-DD').value}`;
            const tanggalHabis = `${document.getElementById('tanggal-habis-YYYY').value}-${document.getElementById('tanggal-habis-MM').value}-${document.getElementById('tanggal-habis-DD').value}`;
            const namaPaket = document.getElementById('nama-paket').value;
            const kuota = document.getElementById('kuota-paket').value + 'GB';
            const biaya = parseFloat(document.getElementById('biaya-paket').value);

            // Validasi data
            if (tanggalBeli && tanggalHabis && namaPaket && kuota && !isNaN(biaya)) {
                // Ambil data dari localStorage
                const savedData = localStorage.getItem('biayaData');
                const biayaData = savedData ? JSON.parse(savedData) : defaultBiayaData;

                // Tambahkan data baru
                biayaData.push({
                    tanggal_beli: tanggalBeli,
                    tanggal_habis: tanggalHabis,
                    nama_paket: namaPaket,
                    kuota: kuota,
                    biaya: biaya
                });

                // Simpan data ke localStorage
                saveBiayaData(biayaData);

                // Muat ulang tabel
                loadBiayaData();
                loadRekapBiaya();

                // Tutup modal dan reset form
                closeModal();
            } else {
                alert('Data tidak valid! Pastikan semua kolom diisi dengan benar.');
            }
        }

        document.getElementById('add-package-form').addEventListener('submit', addPackageSubmit);

        // Tutup modal saat klik di luar konten
        window.onclick = function(event) {
            const modal = document.getElementById('modal-form');
            if (event.target == modal) {
                closeModal();
            }
        }

        // Fungsi untuk memformat angka ke format Rupiah
        function formatRupiah(number) {
            return 'Rp ' + number.toLocaleString('id-ID', { minimumFractionDigits: 0 });
        }

        // Fungsi untuk menghitung total kuota
        function calculateTotalKuota(biayaData) {
            let totalKuota = 0;

            biayaData.forEach(entry => {
                const kuota = entry.kuota.toLowerCase();

                if (kuota.includes("gb")) {
                    totalKuota += parseFloat(kuota.replace("gb", ""));
                }
            });

            return totalKuota;
        }

        // Fungsi untuk mengedit data
        function editRow(index) {
            const savedData = localStorage.getItem('biayaData');
            const biayaData = savedData ? JSON.parse(savedData) : defaultBiayaData;

            const entry = biayaData[index];

            // Buka modal dan isi dengan data yang ada
            document.getElementById('modal-form').style.display = 'block';

            // Isi form dengan data yang ada
            const [beliYYYY, beliMM, beliDD] = entry.tanggal_beli.split('-');
            document.getElementById('tanggal-beli-YYYY').value = beliYYYY;
            document.getElementById('tanggal-beli-MM').value = beliMM;
            document.getElementById('tanggal-beli-DD').value = beliDD;

            const [habisYYYY, habisMM, habisDD] = entry.tanggal_habis.split('-');
            document.getElementById('tanggal-habis-YYYY').value = habisYYYY;
            document.getElementById('tanggal-habis-MM').value = habisMM;
            document.getElementById('tanggal-habis-DD').value = habisDD;

            document.getElementById('nama-paket').value = entry.nama_paket;
            document.getElementById('kuota-paket').value = parseFloat(entry.kuota);
            document.getElementById('biaya-paket').value = entry.biaya;

            // Ubah event listener form submit untuk menyimpan perubahan
            document.getElementById('add-package-form').onsubmit = function(e) {
                e.preventDefault();

                // Ambil data dari form
                const tanggalBeli = `${document.getElementById('tanggal-beli-YYYY').value}-${document.getElementById('tanggal-beli-MM').value}-${document.getElementById('tanggal-beli-DD').value}`;
                const tanggalHabis = `${document.getElementById('tanggal-habis-YYYY').value}-${document.getElementById('tanggal-habis-MM').value}-${document.getElementById('tanggal-habis-DD').value}`;
                const namaPaket = document.getElementById('nama-paket').value;
                const kuota = document.getElementById('kuota-paket').value + 'GB';
                const biaya = parseFloat(document.getElementById('biaya-paket').value);

                if (tanggalBeli && tanggalHabis && namaPaket && kuota && !isNaN(biaya)) {
                    // Update data
                    biayaData[index] = {
                        tanggal_beli: tanggalBeli,
                        tanggal_habis: tanggalHabis,
                        nama_paket: namaPaket,
                        kuota: kuota,
                        biaya: biaya
                    };

                    // Simpan perubahan
                    saveBiayaData(biayaData);

                    // Muat ulang tabel
                    loadBiayaData();
                    loadRekapBiaya();

                    // Tutup modal dan reset form
                    closeModal();
                } else {
                    alert('Data tidak valid! Pastikan semua kolom diisi dengan benar.');
                }
            };
        }

        // Fungsi untuk menghapus data
        function deleteRow(index) {
            const confirmDelete = confirm('Apakah Anda yakin ingin menghapus data ini?');
            if (confirmDelete) {
                const savedData = localStorage.getItem('biayaData');
                const biayaData = savedData ? JSON.parse(savedData) : defaultBiayaData;

                // Hapus data berdasarkan indeks
                biayaData.splice(index, 1);

                // Simpan perubahan
                saveBiayaData(biayaData);

                // Muat ulang tabel
                loadBiayaData();
                loadRekapBiaya();
            }
        }

        // Fungsi untuk memuat data biaya
        function loadBiayaData() {
            const savedData = localStorage.getItem('biayaData');
            const biayaData = savedData ? JSON.parse(savedData) : defaultBiayaData;

            const tableBody = document.getElementById('biaya-table-body');
            tableBody.innerHTML = ''; // Kosongkan tabel sebelum diisi ulang

            let totalBiaya = 0;
            let totalKuota = 0;

            biayaData.forEach((entry, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${entry.tanggal_beli}</td>
                    <td>${entry.tanggal_habis}</td>
                    <td>${entry.nama_paket}</td>
                    <td>${entry.kuota}</td>
                    <td>${formatRupiah(entry.biaya)}</td>
                    <td>
                        <button class="edit-button" onclick="editRow(${index})">Edit</button>
                        <button class="delete-button" onclick="deleteRow(${index})">Delete</button>
                    </td>
                `;
                tableBody.appendChild(row);

                // Tambahkan biaya ke total
                totalBiaya += entry.biaya;

                // Hitung total kuotaa
                const kuotaValue = parseFloat(entry.kuota.toLowerCase().replace('gb', ''));
                if (!isNaN(kuotaValue)) {
                    totalKuota += kuotaValue;
                }
            });

            // Update total kuota dan biaya
            document.getElementById('total-kuota').textContent = `${totalKuota} GB`;
            document.getElementById('total-biaya').textContent = formatRupiah(totalBiaya);
        }

        // Fungsi untuk menghitung rekap biaya per bulan
        function loadRekapBiaya() {
            const savedData = localStorage.getItem('biayaData');
            const biayaData = savedData ? JSON.parse(savedData) : defaultBiayaData;

            const rekapBody = document.getElementById('rekap-biaya-body');
            rekapBody.innerHTML = ''; // Kosongkan tabel sebelum diisi ulang

            const rekap = {};

            biayaData.forEach(entry => {
                const bulan = entry.tanggal_beli.substring(0, 7); // Format: YYYY-MM
                if (rekap[bulan]) {
                    rekap[bulan].biaya += entry.biaya;
                } else {
                    rekap[bulan] = {
                        biaya: entry.biaya
                    };
                }
            });

            let totalKeseluruhanBiaya = 0;
            let totalKeseluruhanKuota = 0;

            for (const bulan in rekap) {
                const totalKuota = calculateTotalKuotaPerBulan(bulan, biayaData); // Hitung total kuota per bulan
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${formatBulanTahun(bulan)}</td>
                    <td>${formatRupiah(rekap[bulan].biaya)}</td>
                    <td>${totalKuota} GB</td>
                `;
                rekapBody.appendChild(row);

                totalKeseluruhanBiaya += rekap[bulan].biaya;
                totalKeseluruhanKuota += totalKuota;
            }

            // Update total keseluruhan biaya dan kuota
            document.getElementById('total-keseluruhan-biaya').textContent = formatRupiah(totalKeseluruhanBiaya);
            document.getElementById('total-keseluruhan-kuota').textContent = `${totalKeseluruhanKuota} GB`;
        }

        // Fungsi untuk menghitung total kuota per bulan
        function calculateTotalKuotaPerBulan(bulan, biayaData) {
            let totalKuota = 0;

            biayaData.forEach(entry => {
                const bulanData = entry.tanggal_beli.substring(0, 7); // Format: YYYY-MM
                if (bulanData === bulan) {
                    const kuota = entry.kuota.toLowerCase();
                    if (kuota.includes("gb")) {
                        totalKuota += parseFloat(kuota.replace("gb", ""));
                    }
                }
            });

            return totalKuota;
        }

        // Fungsi untuk mengubah format YYYY-MM menjadi Nama Bulan YYYY
        function formatBulanTahun(tanggal) {
            const bulan = [
                "Januari", "Februari", "Maret", "April", "Mei", "Juni",
                "Juli", "Agustus", "September", "Oktober", "November", "Desember"
            ];
            const [tahun, bulanIndex] = tanggal.split("-");
            return `${bulan[parseInt(bulanIndex, 10) - 1]} ${tahun}`;
        }

        // Panggil fungsi saat halaman dimuat
        document.addEventListener('DOMContentLoaded', () => {
            loadBiayaData();
            loadRekapBiaya();
        });

        // Fungsi untuk menampilkan tab utama
        function showTab(tabId) {
            // Hide all main tabs
            const tabs = document.querySelectorAll('main');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Remove active class from main nav buttons
            const buttons = document.querySelectorAll('nav button');
            buttons.forEach(button => button.classList.remove('active'));

            // Show selected main tab
            document.getElementById(tabId).classList.add('active');
            document.getElementById(`${tabId}-tab`).classList.add('active');
        }

        // Fungsi untuk menampilkan interface dalam sub-nav
        function showInterface(interfaceId) {
            // Hide all interface sections
            const sections = document.querySelectorAll('.interface-section');
            sections.forEach(section => section.classList.remove('active'));

            // Remove active class dari sub-nav buttons
            const buttons = document.querySelectorAll('.sub-nav button');
            buttons.forEach(button => button.classList.remove('active'));

            // Show selected interface section
            document.getElementById(`${interfaceId}-section`).classList.add('active');
            document.getElementById(`${interfaceId}-button`).classList.add('active');
        }

        // Fungsi untuk menampilkan sub-interface Biaya
        function showBiayaInterface(interfaceId) {
            // Hide semua interface sections dalam Biaya
            const sections = document.querySelectorAll('#biaya .interface-section');
            sections.forEach(section => section.classList.remove('active'));

            // Remove active class dari sub-nav Biaya buttons
            const buttons = document.querySelectorAll('#biaya .sub-nav button');
            buttons.forEach(button => button.classList.remove('active'));

            // Show selected interface section
            document.getElementById(`biaya-${interfaceId}-section`).classList.add('active');
            document.getElementById(`biaya-${interfaceId}-button`).classList.add('active');
        }

        // Fungsi untuk toggle tema
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute("data-theme");
            const newTheme = currentTheme === "dark" ? "light" : "dark";
            const icon = document.getElementById('theme-icon');
            if (newTheme === "dark") {
                icon.src = "https://img.icons8.com/ios-filled/50/000000/moon-symbol.png";
            } else {
                icon.src = "https://img.icons8.com/ios-filled/50/000000/sun--v1.png";
            }
            document.documentElement.setAttribute("data-theme", newTheme);
            localStorage.setItem("theme", newTheme);
        }

        // Fungsi untuk memuat tema saat halaman dimuat
        function loadTheme() {
            const savedTheme = localStorage.getItem("theme") || "light";
            const icon = document.getElementById('theme-icon');
            if (savedTheme === "dark") {
                icon.src = "https://img.icons8.com/ios-filled/50/000000/moon-symbol.png";
            } else {
                icon.src = "https://img.icons8.com/ios-filled/50/000000/sun--v1.png";
            }
            document.documentElement.setAttribute("data-theme", savedTheme);
        }

        loadTheme();

        // Fungsi untuk memperbarui gauge
        function updateGauge(gaugeId, value, maxValue) {
            const gauge = document.getElementById(gaugeId);
            const circumference = 2 * Math.PI * 50;
            const offset = circumference - (value / maxValue) * circumference;
            gauge.style.strokeDasharray = circumference;
            gauge.style.strokeDashoffset = offset;

            if (value < 50) {
                gauge.style.stroke = 'var(--low-color)';
            } else if (value >= 50 && value < 80) {
                gauge.style.stroke = 'var(--medium-color)';
            } else {
                gauge.style.stroke = 'var(--high-color)';
            }
        }

        // Fungsi untuk memperbarui status
        function updateStatus() {
            // Fetch data dari server (ganti URL sesuai kebutuhan)
            fetch('/cgi-bin/status').then(response => response.json()).then(data => {
                const cpuTempRounded = Math.round(data.cpu_temp);
                document.getElementById('cpu-temp-value').textContent = cpuTempRounded + '¬∞C';
                updateGauge('cpu-temp-gauge', cpuTempRounded, 100);

                const cpuLoadRounded = Math.round(data.cpu_load);
                document.getElementById('cpu-load-value').textContent = cpuLoadRounded + '%';
                updateGauge('cpu-load-gauge', cpuLoadRounded, 100);

                const ramUsageRounded = data.ram_usage.toFixed(1);
                document.getElementById('ram-usage-value').textContent = ramUsageRounded + '%';
                updateGauge('ram-usage-gauge', ramUsageRounded, 100);

                const diskUsageRounded = data.disk_usage.toFixed(1);
                document.getElementById('disk-usage-value').textContent = diskUsageRounded + '%';
                updateGauge('disk-usage-gauge', diskUsageRounded, 100);

                document.getElementById('uptime').textContent = data.uptime;

                 const vnstat = data.vnstat;

                document.getElementById('br-lan-today-date').textContent = vnstat['br-lan'].today.date;
                document.getElementById('br-lan-today-total').textContent = vnstat['br-lan'].today.total;

                document.getElementById('br-lan-month-date').textContent = vnstat['br-lan'].month.date;
                document.getElementById('br-lan-month-total').textContent = vnstat['br-lan'].month.total;

                document.getElementById('br-lan-last-month-date').textContent = vnstat['br-lan'].last_month.date;
                document.getElementById('br-lan-last-month-total').textContent = vnstat['br-lan'].last_month.total;

                document.getElementById('wwan0-today-date').textContent = vnstat['wwan0'].today.date;
                document.getElementById('wwan0-today-total').textContent = vnstat['wwan0'].today.total;

                document.getElementById('wwan0-month-date').textContent = vnstat['wwan0'].month.date;
                document.getElementById('wwan0-month-total').textContent = vnstat['wwan0'].month.total;

                document.getElementById('wwan0-last-month-date').textContent = vnstat['wwan0'].last_month.date;
                document.getElementById('wwan0-last-month-total').textContent = vnstat['wwan0'].last_month.total;

                document.getElementById('usb0-today-date').textContent = vnstat['usb0'].today.date;
                document.getElementById('usb0-today-total').textContent = vnstat['usb0'].today.total;

                document.getElementById('usb0-month-date').textContent = vnstat['usb0'].month.date;
                document.getElementById('usb0-month-total').textContent = vnstat['usb0'].month.total;

                document.getElementById('usb0-last-month-date').textContent = vnstat['usb0'].last_month.date;
                document.getElementById('usb0-last-month-total').textContent = vnstat['usb0'].last_month.total;
            });
        }
        
    function loadCurrentMonth() {
        const currentDate = new Date();
        const monthNames = [
            "Januari", "Februari", "Maret", "April", "Mei", "Juni",
            "Juli", "Agustus", "September", "Oktober", "November", "Desember"
        ];
        const currentMonth = `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
        document.getElementById('current-month').textContent = `Bulan: ${currentMonth}`;
    }

    // Panggil fungsi saat halaman dimuat
    document.addEventListener('DOMContentLoaded', () => {
        loadCurrentMonth();
        loadBandwidthData(); // Memuat data bandwidth
    });

// Fungsi untuk mengonversi string bandwidth (misalnya "123 MB") ke nilai numerik dalam byte
function parseBandwidth(bandwidthStr) {
  const parts = bandwidthStr.split(" ");
  if (parts.length < 2) return 0;
  const value = parseFloat(parts[0]);
  const unit = parts[1].toUpperCase();
  switch (unit) {
    case 'B':
      return value;
    case 'KB':
      return value * 1024;
    case 'MB':
      return value * 1024 * 1024;
    case 'GB':
      return value * 1024 * 1024 * 1024;
    default:
      return value;
  }
}

    // Fungsi untuk memuat data bandwidth
function loadBandwidthData() {
  fetch('/cgi-bin/pemakaian/pemakaian.sh')
    .then(response => response.json())
    .then(data => {
      const tableBody = document.getElementById('bandwidth-data').querySelector('tbody');
      tableBody.innerHTML = ''; // Kosongkan tabel sebelum diisi ulang

      // Urutkan data berdasarkan total download secara menurun
      data.clients.sort((a, b) => parseBandwidth(b.bandwidth.download) - parseBandwidth(a.bandwidth.download));

      data.clients.forEach((client, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${client.name}</td>
          <td>${client.ip}</td>
          <td>${client.mac}</td>
          <td>${client.bandwidth.download}</td>
          <td>${client.bandwidth.upload}</td>
        `;
        tableBody.appendChild(row);
      });
    })
    .catch(error => console.error('Error loading bandwidth data:', error));
}

    // Perbarui data bandwidth setiap 5 detik
    setInterval(loadBandwidthData, 5000);

    function showTab(tabId) {
        // Hide all main tabs
        const tabs = document.querySelectorAll('main');
        tabs.forEach(tab => tab.classList.remove('active'));

        // Remove active class from nav buttons
        const buttons = document.querySelectorAll('nav button');
        buttons.forEach(button => button.classList.remove('active'));

        // Show the selected tab
        document.getElementById(tabId).classList.add('active');
        document.getElementById(`${tabId}-tab`).classList.add('active');
    }

        // Panggil updateStatus setiap 3 detik
        setInterval(updateStatus, 3000);

        // Fungsi untuk memperbarui data mingguan
        function updateWeeklyData(weekNumber) {
            let endpoint = weekNumber === 5 ? '/cgi-bin/mingguterakhir' : `/cgi-bin/minggu${weekNumber}`;
            fetch(endpoint)
                .then(response => response.json())
                .then(data => {
                    if (data.vnstat) {
                        ['wwan0', 'usb0', 'br-lan'].forEach(interface => {
                            document.getElementById(`${interface}-week${weekNumber}-total`).textContent = data.vnstat[interface].total;
                        });
                    }
                })
                .catch(error => console.error(`Error loading weekly data for week ${weekNumber}:`, error));
        }

        // Update all weekly data
        setInterval(() => {
  [1, 2, 3, 4, 5].forEach(week => updateWeeklyData(week));
}, 3000);
    </script>
</body>
</html>
